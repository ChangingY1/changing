<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.changing.classroom.activity.mapper.UserActivityMapper">

    <sql id="columns">
        id,user_id userId,activity_id activityId,create_time createTime,update_time updateTime,is_deleted isDeleted
    </sql>

<!--    //4 用户删除-->
    <update id="deleteById">
        update users_activities set is_deleted=1 where id=#{id}
    </update>


<!--    //3 用户修改-->
    <update id="update">
        update users_activities set
        <if test="userId != null and userId != ''">
            user_id = #{userId},
        </if>
        <if test="activityId != null and activityId != ''">
            activity_id = #{activityId},
        </if>
        update_time = now()
        where
        id = #{id}
    </update>

<!--    //2 用户添加-->
    <insert id="save">
        insert into users_activities (id,
                                      user_id,
                                      activity_id)
        values (#{id},
                #{userId},
                #{activityId})

    </insert>

    <select id="selectById" resultType="com.changing.classroom.model.entity.relation.UARelation">
        SELECT <include refid="columns"/>
        FROM users_activities
        WHERE id=#{id}
        and is_deleted=0
    </select>
    <select id="select" resultType="com.changing.classroom.model.entity.relation.UARelation">
        SELECT <include refid="columns"/>
        FROM users_activities
        WHERE user_id = #{userId}
        and activity_id = #{activityId}
        and is_deleted=0
    </select>


</mapper>